# v0.3.4 — Skills Convention & Windows Build Improvements

Support for the `.agents/skills` convention and major Windows build reliability improvements.

---

## ✨ Support for `.agents/skills` Convention

Skills can now be placed in the `.agents/skills` directory, following the emerging cross-tool standard.

### What's New

**Cross-Tool Compatibility**
Place your skills in `~/.agents/skills/` and they'll work with Craft Agents, Codex, Gemini, and other tools that support this convention. Your existing workspace skills continue to work as before.

> Addresses [craft-agents-oss#171](https://github.com/lukilabs/craft-agents-oss/issues/171)

---

## ✨ Theme Configuration Priority Fix

Config file theme settings now correctly override localStorage.

### How It Works

**Config as Source of Truth**
When you set `colorTheme` in `~/.craft-agent/config.json`, it now properly takes priority over any cached theme in localStorage. This makes it possible for agents to modify the theme via documented config paths.

> Fixes [craft-agents-oss#178](https://github.com/lukilabs/craft-agents-oss/issues/178)

---

## Improvements

### Error Handling
- Helpful messages for AI provider errors (internal server error, api_error) with guidance to check status page ([craft-agents-oss#166](https://github.com/lukilabs/craft-agents-oss/issues/166))
- Custom model support now works correctly in summarization — uses `resolveModelId()` for all internal model calls ([craft-agents-oss#168](https://github.com/lukilabs/craft-agents-oss/issues/168))

### Skills
- Fixed skill mention format — `@` mentions now generate correct workspace alias format instead of raw UUIDs ([craft-agents-oss#174](https://github.com/lukilabs/craft-agents-oss/issues/174))
- Steps scroll behavior improvements — "Steps Completed" now scrolls to most recent step

### UI
- Prevent EditPopover from rendering outside viewport
- Fix time display showing "60m" instead of "1h"
- Preserve newlines in multiline user messages (Shift+Enter)

### Linux (Hyprland/Wayland)
- Window close timeout fallback for Hyprland/Wayland where IPC may fail ([craft-agents-oss#131](https://github.com/lukilabs/craft-agents-oss/issues/131))

---

## Bug Fixes

- **Skills**: Fixed `@` skill mentions generating wrong ID format (UUID instead of workspace alias)
- **UI**: EditPopover now stays within viewport bounds
- **Linux**: Window close timeout fallback for Hyprland/Wayland environments

---

## Build & CI (Windows)

Major improvements to Windows build reliability:

- Bundle packages instead of marking as external for better compatibility
- Use `--linker=hoisted` for Windows bun install to avoid `.bun` symlinks
- Bundle SDK via extraResources to bypass node_modules exclusion
- Added `bun.lock` for consistent cross-platform builds
- Correct app bundle name in afterPack.cjs
- Multiple symlink handling fixes for Windows packaging

---

## GitHub Issues

| Issue | Title | Status |
|-------|-------|--------|
| [craft-agents-oss#131](https://github.com/lukilabs/craft-agents-oss/issues/131) | Craft Agents on Hyprland creates multiple non-closable windows | Fixed |
| [craft-agents-oss#166](https://github.com/lukilabs/craft-agents-oss/issues/166) | Unknown Error is impossible to diagnose | Fixed |
| [craft-agents-oss#168](https://github.com/lukilabs/craft-agents-oss/issues/168) | Custom Model fails with "unknown provider for model claude-haiku..." | Fixed |
| [craft-agents-oss#171](https://github.com/lukilabs/craft-agents-oss/issues/171) | Support .agents/skills convention | Fixed |
| [craft-agents-oss#174](https://github.com/lukilabs/craft-agents-oss/issues/174) | @ Mention Generates Wrong Skill ID Format | Fixed |
| [craft-agents-oss#178](https://github.com/lukilabs/craft-agents-oss/issues/178) | Color theme in config.json is ignored on startup | Fixed |

---

## Stats

- **32 files changed**
- **~4,200 lines added**

---

**Full Changelog**: [v0.3.3...v0.3.4](https://github.com/lukilabs/craft-agents/compare/v0.3.3...v0.3.4)
